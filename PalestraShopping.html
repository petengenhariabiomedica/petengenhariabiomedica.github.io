<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscrições - PET Engenharia Biomédica</title>
    <link rel="stylesheet" href="styleInscrição.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <section class="subheader2">
        <nav>
            <a href="index.html"><img src="images/Logo PET SFundo.png" alt="PET Engenharia Biomédica"></a>
            <div class="nav-links" id="navLinks">
                <i class="fa fa-times" onclick="hideMenu()"></i>
                <ul>
                    <li><a href="index.html">INÍCIO</a></li>
                    <li><a href="about.html">SOBRE</a></li>
                    <li><a href="AbaInscrições.html">INSCRIÇÕES</a></li>
                    <li><a href="https://linktr.ee/petebio">VEM PRO PET</a></li>
                    <li><a href="https://seb2025.sciencesconf.org/">SEB</a></li>
                </ul>
            </div>
            <i class="fa fa-bars" onclick="showMenu()"></i>
        </nav>
        
        <div class="text-box">
            <h1>Inscrição - Palestra UFU & Center Shopping</h1>
            <p>Preencha o formulário abaixo para se inscrever em nossa palestra!</p>
        </div>
    </section>

    <div class="main-container">
        <div class="form-card">
            <h2 class="form-title">Preencha seus dados</h2>
            
            <div id="statusMessage" class="status-message"></div>
            
            <form id="formInscricao">
                <div class="form-group">
                    <label for="nome" class="form-label">Nome Completo</label>
                    <input type="text" id="nome" name="nome" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="email" class="form-label">E-mail Institucional</label>
                    <input type="email" id="email" name="email" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="confirmarEmail" class="form-label">Confirmar E-mail</label>
                    <input type="email" id="confirmarEmail" name="confirmarEmail" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="matricula" class="form-label">Matrícula (UFU)</label>
                    <input type="text" id="matricula" name="matricula" class="form-input">
                </div>

                <div class="form-group">
                    <label for="cpf" class="form-label">CPF</label>
                    <input type="text" id="cpf" name="cpf" class="form-input" 
                        pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" 
                        title="Formato: 000.000.000-00" required>
                </div>
                       
                <button type="submit" class="submit-btn" id="submitButton">
                    <span id="buttonText">Enviar Inscrição</span>
                </button>
            </form>
        </div>

        <div class="info-section">
            <h3 class="info-title">Informações Importantes</h3>
            <ul class="info-list">
                <li>Os minicursos têm vagas limitadas</li>
                <li>Certificado de participação para quem tiver 75% de presença</li>
                <li>Dúvidas? Entre em contato pelo e-mail pet.engenhariabiomedica.ufu@gmail.com</li>
            </ul>
        </div>
    </div>

    <!-- Rodapé -->
<section class="sobre">
    <h4>O que é o PET?</h4>
    <p>O Programa de Educação Tutorial (PET) Engenharia Biomédica é um grupo acadêmico que busca integrar ensino, <br>
        pesquisa e extensão para complementar a formação dos alunos do curso. Composto por estudantes e orientado <br>
        por um tutor, o PET desenvolve atividades que estimulam o pensamento crítico, a inovação e o trabalho em equipe.</p>
        <div class="icones">    
            <a href="https://www.instagram.com/petengenhariabiomedica/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://www.facebook.com/PetEngenhariaBiomedicaUfu/?locale=pt_BR" target="_blank"><i class="fa-brands fa-facebook"></i></a>
            <a href="https://www.linkedin.com/company/pet-engenharia-biomédica-ufu/" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
            <a href="mailto:pet.engenhariabiomedica.ufu@gmail.com"><i class="fa-solid fa-envelope"></i></a>
        </div>        
        <p>Feito por PET - Engenharia Biomédica UFU</p>
</section>

    <script>
        // Configuração para Google Sheets
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxhN2Re3vET7d6RlxLiT-tt8SWutb7AWb3_hu_4PNyW1kLkLEafyfKe2r5zWLBW-f1Bkg/exec';

        document.addEventListener('DOMContentLoaded', function() {
            // Atualiza o ano no footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            const formInscricao = document.getElementById('formInscricao');
            const statusMessage = document.getElementById('statusMessage');
            const submitBtn = document.getElementById('submitButton');
            const buttonText = document.getElementById('buttonText');
            
            // Validação em tempo real para os campos
            const inputs = document.querySelectorAll('.form-input');
            
            inputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.checkValidity()) {
                        this.classList.remove('invalid');
                        this.classList.add('valid');
                    } else {
                        this.classList.remove('valid');
                        this.classList.add('invalid');
                    }
                });
                
                // Limpa as classes de validação quando o usuário começa a digitar
                input.addEventListener('input', function() {
                    this.classList.remove('valid', 'invalid');
                });
            });

            // Máscara para CPF
            const cpfInput = document.getElementById('cpf');
            if (cpfInput) {
                cpfInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    
                    if (value.length > 3) {
                        value = value.replace(/^(\d{3})/, '$1.');
                    }
                    if (value.length > 7) {
                        value = value.replace(/^(\d{3})\.(\d{3})/, '$1.$2.');
                    }
                    if (value.length > 11) {
                        value = value.replace(/^(\d{3})\.(\d{3})\.(\d{3})/, '$1.$2.$3-');
                    }
                    
                    e.target.value = value.substring(0, 14);
                });
            }
            
            formInscricao.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Desabilita o botão e mostra spinner
                submitBtn.disabled = true;
                buttonText.innerHTML = '<span class="loading-spinner"></span> Enviando...';
                
                // Valida se os e-mails coincidem
                const email = document.getElementById('email').value;
                const confirmarEmail = document.getElementById('confirmarEmail').value;
                
                if (email !== confirmarEmail) {
                    statusMessage.textContent = 'Os e-mails digitados não coincidem!';
                    statusMessage.className = 'status-message error';
                    submitBtn.disabled = false;
                    buttonText.textContent = 'Enviar Inscrição';
                    return;
                }
                
                // Mostra mensagem de carregamento
                statusMessage.textContent = 'Enviando inscrição...';
                statusMessage.className = 'status-message';
                
                try {
                    // Prepara os dados para envio
                    const formData = new FormData(formInscricao);
                    formData.append('curso', 'Palestra UFU & Center Shopping');
                    formData.append('data', new Date().toLocaleString());
                    
                    // Configura timeout de 8 segundos
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 8000);
                    
                    // Envia para o Google Sheets via Apps Script
                    const response = await fetch(scriptURL, {
                        method: 'POST',
                        body: formData,
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error('Erro na rede');
                    }
                    
                    // Sucesso
                    statusMessage.textContent = '✅ Inscrição realizada com sucesso!';
                    statusMessage.className = 'status-message success';
                    formInscricao.reset();
                    
                } catch (error) {
                    // Erro
                    console.error('Erro:', error);
                    statusMessage.textContent = error.name === 'AbortError' ? 
                        'A conexão está lenta. Verifique sua inscrição mais tarde.' :
                        'Ocorreu um erro ao enviar. Por favor, tente novamente.';
                    statusMessage.className = 'status-message error';
                } finally {
                    // Reabilita o botão
                    submitBtn.disabled = false;
                    buttonText.textContent = 'Enviar Inscrição';
                }
            });
        });

        // Funções para o menu mobile
        function showMenu() {
            document.getElementById("navLinks").style.right = "0";
        }
        
        function hideMenu() {
            document.getElementById("navLinks").style.right = "-200px";
        }
    </script>
</body>
</html>